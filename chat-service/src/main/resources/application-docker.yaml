spring:
  application:
    name: chat-service

  data:
    mongodb:
      # Connection pool tuned via URI parameters
      uri: ${SPRING_DATA_MONGODB_URI:mongodb://mongo:27017/blink_chat?minPoolSize=10&maxPoolSize=100}
      auto-index-creation: false # Best practice for production
    redis:
      host: ${SPRING_DATA_REDIS_HOST:redis}
      port: ${SPRING_DATA_REDIS_PORT:6379}
      password: ${SPRING_DATA_REDIS_PASSWORD:}
      lettuce:
        pool:
          max-active: ${SPRING_DATA_REDIS_POOL_MAX_ACTIVE:8}
          max-idle: ${SPRING_DATA_REDIS_POOL_MAX_IDLE:8}
          min-idle: ${SPRING_DATA_REDIS_POOL_MIN_IDLE:0}
          max-wait: ${SPRING_DATA_REDIS_POOL_MAX_WAIT:-1ms}

  mail:
    brevo:
      api-key: ${BREVO_API_KEY}
      api-url: ${BREVO_API_URL:https://api.brevo.com/v3/smtp/email}
    sender:
      email: ${BREVO_SENDER_EMAIL}
      name: ${BREVO_SENDER_NAME:Blink}

springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html

server:
  port: ${SERVER_PORT:8080}
  servlet:
    context-path: /
  # Tomcat embedded server tuning
  tomcat:
    threads:
      max: ${SERVER_TOMCAT_MAX_THREADS:200}
      min-spare: ${SERVER_TOMCAT_MIN_SPARE_THREADS:10}
    connection-timeout: ${SERVER_TOMCAT_CONNECTION_TIMEOUT:20000ms}

jwt:
  secret: ${JWT_SECRET:2e804WBYw6Ke/fBUrvcmS9CHUeZK9uLzUw1A4qbh8vY=}
  expiration: ${JWT_EXPIRATION:86400000}          # 24 hours
  refresh-expiration: ${JWT_REFRESH_EXPIRATION:2592000000}  # 30 days

app:
  otp:
    length: ${APP_OTP_LENGTH:6}
    expiration: ${APP_OTP_EXPIRATION:300000}
  phone-prefix: ${APP_PHONE_PREFIX:+91}
  sms:
    enabled: ${APP_SMS_ENABLED:true}
    provider: ${APP_SMS_PROVIDER:twilio}
    twilio:
      account-sid: ${TWILIO_ACCOUNT_SID:}
      auth-token: ${TWILIO_AUTH_TOKEN:}
      from-number: ${TWILIO_FROM_NUMBER:+12052674639}

  cors:
    allowed-origins: ${APP_CORS_ALLOWED_ORIGINS:https://blinx-app.netlify.app,http://k8s-blinkcha-blinkcha-15ee8fd614-2137738643.ap-south-1.elb.amazonaws.com,http://localhost:8080,http://localhost:5173,http://localhost:5174}

api:
  server:
    # Here I have to use service DNS or public URL instead of localhost
    url: ${API_SERVER_URL:http://chat-service:8080}

ai:
  provider: ${AI_PROVIDER:openai}
  api-key: ${AI_API_KEY:}
  base-url: ${AI_BASE_URL:https://api.openai.com}
  model: ${AI_MODEL:gpt-4o-mini}

  mcp:
    client:
      enabled: ${MCP_CLIENT_ENABLED:true}
      servers:
        name: chat-service-mcp-server
        type: SYNC
        example-server:
          transport: stdio
          command: node
          args:
            - ./mcp-server/index.js
          env:
            NODE_ENV: production

web:
  search:
    api-key: ${WEB_SEARCH_API_KEY:}
    cache:
      ttl:
        seconds: ${WEB_SEARCH_CACHE_TTL_SECONDS:300}
    timeout:
      seconds: ${WEB_SEARCH_TIMEOUT_SECONDS:10}

logging:
  file:
    name: ${LOG_FILE_PATH:./logs/chat-service-mcp.log}
